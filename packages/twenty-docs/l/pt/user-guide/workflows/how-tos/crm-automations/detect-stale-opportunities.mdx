---
title: Detectar oportunidades estagnadas
description: Notifique automaticamente os gestores quando as oportunidades n√£o tiverem sido atualizadas.
---

Mantenha o seu pipeline saud√°vel alertando os gestores quando as oportunidades ficarem estagnadas. Este fluxo de trabalho verifica oportunidades que n√£o foram atualizadas h√° um n√∫mero espec√≠fico de dias.

## O Problema

Oportunidades sem atualiza√ß√µes levam a:

* Neg√≥cios a arrefecer
* Previs√µes pouco fi√°veis
* Perda de receita

## A Solu√ß√£o

Crie um fluxo de trabalho agendado que encontre oportunidades estagnadas e envie e-mails aos respetivos gestores.

## Configura√ß√£o passo a passo

### Etapa 1: Criar o fluxo de trabalho

1. V√° para **Configura√ß√µes ‚Üí Fluxos de trabalho**
2. Clique em **+ Novo fluxo de trabalho**
3. D√™ o nome "Alerta de Oportunidade Estagnada"

### Etapa 2: Configurar o gatilho

1. Selecione **Agendado**
2. Defina para executar diariamente (por exemplo, todos os dias √†s 08:00)

### Etapa 3: Pesquisar oportunidades estagnadas

1. Adicione a a√ß√£o **Pesquisar Registos**
2. Configurar:

| Campo      | Valor                                         |
| ---------- | --------------------------------------------- |
| **Objeto** | Oportunidades                                 |
| **Filtro** | Atualizado em √© anterior a (hoje - 7 dias)    |
| **Filtro** | Fase n√£o √© "Closed Won" E n√£o √© "Closed Lost" |
| **Limite** | 100                                           |

### Etapa 4: Verificar se algum foi encontrado

1. Adicione a a√ß√£o **Filtro**
2. Condi√ß√£o: `{{searchRecords.length}}` √© maior do que 0
3. Se n√£o houver oportunidades estagnadas, o fluxo de trabalho termina aqui

### Etapa 5: Formatar o alerta (A√ß√£o de C√≥digo)

Adicione uma a√ß√£o de **C√≥digo** para formatar o e-mail:

```javascript
export const main = async (params) => {
  const opportunities = params.opportunities;

  // Group opportunities by owner
  const byOwner = {};
  opportunities.forEach(opp => {
    const ownerEmail = opp.owner?.email || 'unassigned';
    if (!byOwner[ownerEmail]) {
      byOwner[ownerEmail] = [];
    }
    byOwner[ownerEmail].push({
      name: opp.name,
      amount: opp.amount,
      lastUpdated: opp.updatedAt,
      stage: opp.stage
    });
  });

  // Format summary for manager
  let summary = "Stale Opportunities Report\n\n";
  Object.entries(byOwner).forEach(([owner, opps]) => {
    summary += `${owner}: ${opps.length} stale opportunities\n`;
    opps.forEach(opp => {
      summary += `  - ${opp.name} (${opp.stage})\n`;
    });
    summary += "\n";
  });

  return {
    summary,
    totalCount: opportunities.length
  };
};
```

### Etapa 6: Enviar e-mail de alerta

Adicione a a√ß√£o **Enviar e-mail**:

| Campo       | Valor                                                                 |
| ----------- | --------------------------------------------------------------------- |
| **Para**    | sales-manager@yourcompany.com                                         |
| **Assunto** | `üö® {{code.totalCount}} oportunidades estagnadas precisam de aten√ß√£o` |
| **Corpo**   | `{{code.summary}}`                                                    |

### Etapa 7: Testar e ativar

1. Clique em **Testar** para executar o fluxo de trabalho
2. Verifique se o e-mail cont√©m os dados corretos
3. Ative quando estiver pronto

## Op√ß√µes de personaliza√ß√£o

### Alterar o limite de estagna√ß√£o

Modifique o filtro de Pesquisar Registos para alterar de 7 dias para o per√≠odo da sua prefer√™ncia:

* 3 dias para vendas de alto ritmo
* 14 dias para neg√≥cios empresariais
* 30 dias para ciclos de vendas longos

### Alertar representantes individualmente

Em vez de um e-mail √∫nico para o gestor, use **Iterator** para enviar e-mails personalizados a cada representante sobre os seus pr√≥prios neg√≥cios estagnados.

### Adicionar escalonamento

Crie v√°rios fluxos de trabalho com gravidade crescente:

1. Dia 7: E-mail para o representante
2. Dia 14: E-mail para o representante + gestor
3. Dia 21: Criar tarefa para o gestor intervir

### Incluir no Slack

Use **HTTP Request** para enviar para um webhook do Slack em vez de ou al√©m do e-mail.

## Relacionados

* [A√ß√µes de Fluxo de Trabalho](/l/pt/user-guide/workflows/capabilities/workflow-actions)
* [Enviar e-mails a partir de Fluxos de Trabalho](/l/pt/user-guide/workflows/capabilities/send-emails-from-workflows)

---
title: Guia de atualiza√ß√£o
---

## Diretrizes gerais

**Certifique-se sempre de fazer backup do banco de dados antes de iniciar o processo de atualiza√ß√£o** executando `docker exec -it {db_container_name_or_id} pg_dumpall -U {postgres_user} > databases_backup.sql`.

Para restaurar o backup, execute `cat databases_backup.sql | docker exec -i {db_container_name_or_id} psql -U {postgres_user}`.

Se voc√™ usou o Docker Compose, siga estas etapas:

1. No terminal, no host onde o Twenty est√° em execu√ß√£o, desligue o Twenty: `docker compose down`

2. Atualize a vers√£o alterando o valor `TAG` no arquivo .env pr√≥ximo ao seu docker-compose. (Recomendamos consumir a vers√£o `major.minor` como `v0.53`)

3. Traga o Twenty de volta ao ar com `docker compose up -d`

Se voc√™ quiser atualizar sua inst√¢ncia em algumas vers√µes, por exemplo, de v0.33.0 para v0.35.0, voc√™ deve atualizar sua inst√¢ncia sequencialmente, neste exemplo de v0.33.0 para v0.34.0, depois de v0.34.0 para v0.35.0.

**Certifique-se de que ap√≥s cada vers√£o atualizada voc√™ tenha um backup n√£o corrompido.**

## Etapas de atualiza√ß√£o espec√≠ficas da vers√£o

## v1.0

Ol√° Twenty v1.0! üéâ

## v0.60

### Melhorias de Performance

Todas as intera√ß√µes com a API de metadados foram otimizadas para um melhor desempenho, particularmente para manipula√ß√£o de metadados de objetos e opera√ß√µes de cria√ß√£o de espa√ßo de trabalho.

Reformulamos nossa estrat√©gia de cache para priorizar acertos de cache em detrimento de consultas ao banco de dados sempre que poss√≠vel, melhorando significativamente o desempenho das opera√ß√µes da API de metadados.

Se voc√™ encontrar problemas de execu√ß√£o ap√≥s a atualiza√ß√£o, pode ser necess√°rio limpar seu cache para garantir que esteja sincronizado com as altera√ß√µes mais recentes. Execute este comando em seu cont√™iner do twenty-server:

```bash
yarn command:prod cache:flush
```

### v0.55

Atualize sua inst√¢ncia do Twenty para usar a imagem v0.55

Voc√™ n√£o precisa mais executar nenhum comando, a nova imagem cuidar√° automaticamente de executar todas as migra√ß√µes necess√°rias.

### Erro `User does not have permission`

Se voc√™ encontrar erros de autoriza√ß√£o na maioria das solicita√ß√µes ap√≥s a atualiza√ß√£o, pode ser necess√°rio limpar seu cache para rec√°lculo das permiss√µes mais recentes.

Em seu cont√™iner `twenty-server`, execute:

```bash
yarn command:prod cache:flush
```

Este problema √© espec√≠fico para esta vers√£o do Twenty e n√£o dever√° ser necess√°rio em futuras atualiza√ß√µes.

### v0.54

Desde a vers√£o `0.53`, nenhuma a√ß√£o manual √© necess√°ria.

#### Desativa√ß√£o do esquema de metadados

Mesclamos o esquema `metadata` no `core` para simplificar a recupera√ß√£o de dados do `TypeORM`.
Mesclamos o passo do comando `migrate` dentro do comando `upgrade`. N√£o recomendamos a execu√ß√£o manual do `migrate` em nenhum de seus servidores/conteineres de trabalho.

### Desde v0.53

A partir de `0.53`, a atualiza√ß√£o √© feita programaticamente dentro do `DockerFile`, o que significa que, a partir de agora, voc√™ n√£o precisar√° mais executar nenhum comando manualmente.

Certifique-se de manter atualizando sua inst√¢ncia sequencialmente, sem pular qualquer vers√£o principal (por exemplo, `0.43.3` para `0.44.0` √© permitido, mas `0.43.1` para `0.45.0` n√£o √©), caso contr√°rio, pode levar a uma desincroniza√ß√£o na vers√£o do espa√ßo de trabalho que pode resultar em erro de tempo de execu√ß√£o e funcionalidade ausente.

Para verificar se um espa√ßo de trabalho foi migrado corretamente, voc√™ pode revisar sua vers√£o no banco de dados na tabela `core.workspace`.

Deve estar sempre na faixa da vers√£o `major.minor` atual da inst√¢ncia do Twenty, voc√™ pode ver a vers√£o de sua inst√¢ncia no painel de administra√ß√£o (em `/settings/admin-panel`, acess√≠vel se seu usu√°rio tiver a propriedade `canAccessFullAdminPanel` definida como verdadeira no banco de dados) ou executando `echo $APP_VERSION` em seu cont√™iner `twenty-server`.

Para corrigir uma vers√£o de workspace dessincronizada, voc√™ ter√° que atualizar da vers√£o correspondente do twenty seguindo o guia de atualiza√ß√£o relacionado sequencialmente e assim por diante at√© alcan√ßar a vers√£o desejada.

#### Remo√ß√£o do `auditLog`

Removemos o objeto padr√£o auditLog, o que significa que o tamanho do backup pode ser significativamente reduzido ap√≥s esta migra√ß√£o.

### v0.51 para v0.52

Atualize sua inst√¢ncia do Twenty para usar a imagem v0.52

```
yarn database:migrate:prod
yarn command:prod upgrade
```

#### Tenho um espa√ßo de trabalho bloqueado na vers√£o entre `0.52.0` e `0.52.6`

Infelizmente, `0.52.0` e `0.52.6` foram completamente removidos do dockerHub.
Voc√™ ter√° que atualizar manualmente a vers√£o do espa√ßo de trabalho para `0.51.0` no banco de dados e atualizar usando a vers√£o twenty `0.52.11` seguindo o guia de atualiza√ß√£o logo acima.

### v0.50 para v0.51

Atualize sua inst√¢ncia do Twenty para usar a imagem v0.51

```
yarn database:migrate:prod
yarn command:prod upgrade
```

### v0.44.0 para v0.50.0

Atualize sua inst√¢ncia do Twenty para usar a imagem v0.50.0

```
yarn database:migrate:prod
yarn command:prod upgrade
```

#### Muta√ß√£o docker-compose.yml

Esta vers√£o inclui uma muta√ß√£o `docker-compose.yml` para dar ao servi√ßo `worker` acesso ao volume `server-local-data`.
Por favor, atualize seu `docker-compose.yml` local com [v0.50.0 docker-compose.yml](https://github.com/twentyhq/twenty/blob/v0.50.0/packages/twenty-docker/docker-compose.yml)

### v0.43.0 para v0.44.0

Atualize sua inst√¢ncia do Twenty para usar a imagem v0.44.0

```
yarn database:migrate:prod
yarn command:prod upgrade
```

### v0.42.0 para v0.43.0

Atualize sua inst√¢ncia do Twenty para usar a imagem v0.43.0

```
yarn database:migrate:prod
yarn command:prod upgrade
```

Nesta vers√£o, tamb√©m trocamos para a imagem postgres:16 no docker-compose.yml.

#### (Op√ß√£o 1) Migra√ß√£o do banco de dados

Manter a imagem postgres-spilo existente est√° ok, mas voc√™ ter√° que congelar a vers√£o no seu docker-compose.yml para ser 0.43.0.

#### (Op√ß√£o 2) Migra√ß√£o do banco de dados

Se voc√™ quiser migrar seu banco de dados para a nova imagem postgres:16, siga estas etapas:

1. Fa√ßa dump do seu banco de dados do cont√™iner antigo postgres-spilo

```
docker exec -it twenty-db-1 sh
pg_dump -U {YOUR_POSTGRES_USER} -d {YOUR_POSTGRES_DB} > databases_backup.sql
exit
docker cp twenty-db-1:/home/postgres/databases_backup.sql .
```

Certifique-se de que seu arquivo de dump n√£o est√° vazio.

2. Atualize seu docker-compose.yml para usar a imagem postgres:16 como no arquivo [docker-compose.yml](https://raw.githubusercontent.com/twentyhq/twenty/main/packages/twenty-docker/docker-compose.yml).

3. Restaure o banco de dados para o novo cont√™iner postgres:16

```
docker cp databases_backup.sql twenty-db-1:/databases_backup.sql
docker exec -it twenty-db-1 sh
psql -U {YOUR_POSTGRES_USER} -d {YOUR_POSTGRES_DB} -f databases_backup.sql
exit
```

### v0.41.0 para v0.42.0

Atualize sua inst√¢ncia do Twenty para usar a imagem v0.42.0

```
yarn database:migrate:prod
yarn command:prod upgrade-0.42
```

**Vari√°veis de Ambiente**

* Removido: `FRONT_PORT`, `FRONT_PROTOCOL`, `FRONT_DOMAIN`, `PORT`
* Adicionado: `FRONTEND_URL`, `NODE_PORT`, `MAX_NUMBER_OF_WORKSPACES_DELETED_PER_EXECUTION`, `MESSAGING_PROVIDER_MICROSOFT_ENABLED`, `CALENDAR_PROVIDER_MICROSOFT_ENABLED`, `IS_MICROSOFT_SYNC_ENABLED`

### v0.40.0 para v0.41.0

Atualize sua inst√¢ncia do Twenty para usar a imagem v0.41.0

```
yarn database:migrate:prod
yarn command:prod upgrade-0.41
```

**Vari√°veis de Ambiente**

* Removido: `AUTH_MICROSOFT_TENANT_ID`

### v0.35.0 para v0.40.0

Atualize sua inst√¢ncia do Twenty para usar a imagem v0.40.0

```
yarn database:migrate:prod
yarn command:prod upgrade-0.40
```

**Vari√°veis de Ambiente**

* Adicionado: `IS_EMAIL_VERIFICATION_REQUIRED`, `EMAIL_VERIFICATION_TOKEN_EXPIRES_IN`, `WORKFLOW_EXEC_THROTTLE_LIMIT`, `WORKFLOW_EXEC_THROTTLE_TTL`

### v0.34.0 para v0.35.0

Atualize sua inst√¢ncia do Twenty para usar a imagem v0.35.0

```
yarn database:migrate:prod
yarn command:prod upgrade-0.35
```

O comando `yarn database:migrate:prod` aplicar√° as migra√ß√µes √† estrutura do banco de dados (esquemas core e metadata)
O `yarn command:prod upgrade-0.35` cuida da migra√ß√£o de dados de todos os espa√ßos de trabalho.

**Vari√°veis de Ambiente**

* Substitu√≠mos `ENABLE_DB_MIGRATIONS` por `DISABLE_DB_MIGRATIONS` (o valor padr√£o agora √© `false`, voc√™ provavelmente n√£o precisar√° definir nada)

### v0.33.0 para v0.34.0

Atualize sua inst√¢ncia do Twenty para usar a imagem v0.34.0

```
yarn database:migrate:prod
yarn command:prod upgrade-0.34
```

O comando `yarn database:migrate:prod` aplicar√° as migra√ß√µes √† estrutura do banco de dados (esquemas core e metadata)
O `yarn command:prod upgrade-0.34` cuida da migra√ß√£o de dados de todos os espa√ßos de trabalho.

**Vari√°veis de Ambiente**

* Removido: `FRONT_BASE_URL`
* Adicionado: `FRONT_DOMAIN`, `FRONT_PROTOCOL`, `FRONT_PORT`

Atualizamos a forma como lidamos com a URL do frontend.
Agora voc√™ pode definir a URL do frontend usando as vari√°veis `FRONT_DOMAIN`, `FRONT_PROTOCOL` e `FRONT_PORT`.
Se FRONT_DOMAIN n√£o estiver definido, a URL do frontend voltar√° para `SERVER_URL`.

### v0.32.0 para v0.33.0

Atualize sua inst√¢ncia do Twenty para usar a imagem v0.33.0

```
yarn command:prod cache:flush
yarn database:migrate:prod
yarn command:prod upgrade-0.33
```

O comando `yarn command:prod cache:flush` limpar√° o cache do Redis.
O comando `yarn database:migrate:prod` aplicar√° as migra√ß√µes √† estrutura do banco de dados (esquemas core e metadata)
O `yarn command:prod upgrade-0.33` cuida da migra√ß√£o de dados de todos os espa√ßos de trabalho.

A partir desta vers√£o, a imagem twenty-postgres para DB tornou-se obsoleta e o twenty-postgres-spilo √© usado em vez disso.
Se voc√™ quiser continuar usando a imagem twenty-postgres, basta substituir `twentycrm/twenty-postgres:${TAG}` por `twentycrm/twenty-postgres` em docker-compose.yml.

### v0.31.0 para v0.32.0

Atualize sua inst√¢ncia do Twenty para usar a imagem v0.32.0

**Migra√ß√£o de esquema e dados**

```
yarn database:migrate:prod
yarn command:prod upgrade-0.32
```

O comando `yarn database:migrate:prod` aplicar√° as migra√ß√µes √† estrutura do banco de dados (esquemas core e metadata)
O `yarn command:prod upgrade-0.32` cuida da migra√ß√£o de dados de todos os espa√ßos de trabalho.

**Vari√°veis de Ambiente**

Atualizamos a forma como lidamos com a conex√£o Redis.

* Removido: `REDIS_HOST`, `REDIS_PORT`, `REDIS_USERNAME`, `REDIS_PASSWORD`
* Adicionado: `REDIS_URL`

Atualize seu arquivo `.env` para usar a nova vari√°vel `REDIS_URL` em vez dos par√¢metros de conex√£o Redis individuais.

Tamb√©m simplificamos a forma como lidamos com os tokens JWT.

* Removido: `ACCESS_TOKEN_SECRET`, `LOGIN_TOKEN_SECRET`, `REFRESH_TOKEN_SECRET`, `FILE_TOKEN_SECRET`
* Adicionado: `APP_SECRET`

Atualize seu arquivo `.env` para usar a nova vari√°vel `APP_SECRET` em vez dos segredos dos tokens individuais (voc√™ pode usar o mesmo segredo de antes ou gerar uma nova string aleat√≥ria)

**Conta Ligada**

Se voc√™ estiver usando uma conta conectada para sincronizar seus e-mails e calend√°rios do Google, precisar√° ativar a [API People](https://developers.google.com/people) no console de administra√ß√£o do Google.

### v0.30.0 para v0.31.0

Atualize sua inst√¢ncia do Twenty para usar a imagem v0.31.0

**Migra√ß√£o de esquema e dados**:

```
yarn database:migrate:prod
yarn command:prod upgrade-0.31
```

O comando `yarn database:migrate:prod` aplicar√° as migra√ß√µes √† estrutura do banco de dados (esquemas core e metadata)
O `yarn command:prod upgrade-0.31` cuida da migra√ß√£o de dados de todos os espa√ßos de trabalho.

### v0.24.0 para v0.30.0

Atualize sua inst√¢ncia do Twenty para usar a imagem v0.30.0

**Mudan√ßa radical**:
Para melhorar o desempenho, o Twenty agora requer que o cache redis seja configurado. Atualizamos nosso [docker-compose.yml](https://raw.githubusercontent.com/twentyhq/twenty/main/packages/twenty-docker/docker-compose.yml) para refletir isso.
Certifique-se de atualizar sua configura√ß√£o e suas vari√°veis de ambiente adequadamente:

```
REDIS_HOST={your-redis-host}
REDIS_PORT={your-redis-port}
CACHE_STORAGE_TYPE=redis
```

**Migra√ß√£o de esquema e dados**:

```
yarn database:migrate:prod
yarn command:prod upgrade-0.30
```

O comando `yarn database:migrate:prod` aplicar√° as migra√ß√µes √† estrutura do banco de dados (esquemas core e metadata)
O `yarn command:prod upgrade-0.30` cuida da migra√ß√£o de dados de todos os espa√ßos de trabalho.

### v0.23.0 para v0.24.0

Atualize sua inst√¢ncia do Twenty para usar a imagem v0.24.0

Execute os seguintes comandos:

```
yarn database:migrate:prod
yarn command:prod upgrade-0.24
```

O comando `yarn database:migrate:prod` aplicar√° as migra√ß√µes √† estrutura do banco de dados (esquemas core e metadata)
O `yarn command:prod upgrade-0.24` cuida da migra√ß√£o de dados de todos os espa√ßos de trabalho.

### v0.22.0 para v0.23.0

Atualize sua inst√¢ncia do Twenty para usar a imagem v0.23.0

Execute os seguintes comandos:

```
yarn database:migrate:prod
yarn command:prod upgrade-0.23
```

O comando `yarn database:migrate:prod` aplicar√° as migra√ß√µes ao Banco de Dados.
O `yarn command:prod upgrade-0.23` cuida da migra√ß√£o de dados, incluindo a transfer√™ncia de atividades para tarefas/notas.

### v0.21.0 para v0.22.0

Atualize sua inst√¢ncia do Twenty para usar a imagem v0.22.0

Execute os seguintes comandos:

```
yarn database:migrate:prod
yarn command:prod workspace:sync-metadata -f
yarn command:prod upgrade-0.22
```

O comando `yarn database:migrate:prod` aplicar√° as migra√ß√µes ao Banco de Dados.
O comando `yarn command:prod workspace:sync-metadata -f` sincronizar√° a defini√ß√£o de objetos padr√£o com as tabelas de metadados e aplicar√° as migra√ß√µes necess√°rias aos espa√ßos de trabalho existentes.
O comando `yarn command:prod upgrade-0.22` aplicar√° transforma√ß√µes de dados espec√≠ficas para se adaptar √†s novas op√ß√µes padr√£o de requestInstrumentationOptions do objeto.

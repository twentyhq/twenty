---
title: Fila de Mensagens
image: /images/user-guide/emails/emails_header.png
---

<Frame>
  <img src="/images/user-guide/emails/emails_header.png" alt="Header" />
</Frame>

As filas facilitam a execução de operações assíncronas. Elas podem ser usadas para realizar tarefas em segundo plano, como enviar um e-mail de boas-vindas ao registrar.
Cada caso de uso terá sua própria classe de fila estendida de `MessageQueueServiceBase`.

Atualmente, só suportamos `bull-mq`[bull-mq](https://bullmq.io/) como o driver da fila.

## Passos para criar e usar uma nova fila

1. Adicione um nome para a sua nova fila sob o enum `MESSAGE_QUEUES`.
2. Forneça a implementação de fábrica da fila com o nome da fila como o token de dependência.
3. Injete a fila que você criou no módulo/serviço necessário com o nome da fila como o token de dependência.
4. Adicione uma classe de trabalhador com injeção baseada em token, assim como o produtor.

### Uso de exemplo

```ts
class Resolver {
  constructor(@Inject(MESSAGE_QUEUES.custom) private queue: MessageQueueService) {}

  async onSomeAction() {
    //business logic
    await this.queue.add(someData);
  }
}

//async worker
class CustomWorker {
  constructor(@Inject(MESSAGE_QUEUES.custom) private queue: MessageQueueService) {
    this.initWorker();
  }

  async initWorker() {
    await this.queue.work(async ({ id, data }) => {
      //worker logic
    });
  }
}
```


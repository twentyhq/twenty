---
title: Afficher le nombre d'e-mails reçus
description: Créez un workflow pour compter et afficher automatiquement le nombre d'e-mails reçus de chaque contact.
---

import { VimeoEmbed } from '/snippets/vimeo-embed.mdx';

<img src="/images/user-guide/workflows/workflow-number-of-emails-received.png" style={{width:'100%'}} />

## Vue d'ensemble

Ce workflow se déclenche chaque fois qu'un nouvel e-mail est reçu et met à jour un champ personnalisé sur l'enregistrement Person avec le nombre total d'e-mails provenant de cet expéditeur.

## Prérequis

Avant de configurer ce workflow, créez un champ personnalisé sur l'objet **People** :

1. Allez dans **Paramètres → Modèle de données → People**
2. Ajoutez un nouveau champ **Nombre**
3. Nommez-le par exemple "Nombre d'e-mails reçus de cette personne"

## Configuration pas à pas

<VimeoEmbed videoId="1148700336" title="Démonstration vidéo" />

### Étape 1 : Configurer le déclencheur

1. Allez dans **Workflows** et créez un nouveau workflow
2. Sélectionnez **Record is Created** comme déclencheur
3. Choisissez **Message Participants** (disponible sous Advanced objects)

<Note>
  Un Message Participant est une combinaison d'un ID de message et d'un ID de personne, créant un enregistrement unique par message. Ceci est plus facile à suivre que les Messages directement, car nous pouvons accéder au champ `handle`, qui contient l'adresse e-mail de l'expéditeur (ou du destinataire).
</Note>

### Étape 2 : Filtrer sur le rôle

1. Ajoutez l'action **Filtre**
2. Définissez la condition : **Role** est égal à **FROM**

Cela garantit que vous ne comptez que les messages envoyés par cette personne, et non les messages qui lui sont envoyés.

### Étape 3 : Rechercher tous les Message Participants avec le même handle

1. Ajoutez une action **Search Records**
2. Sélectionnez **Message Participants** comme objet
3. Ajoutez des filtres : **Handle** est égal au handle du déclencheur (l'adresse e-mail de l'expéditeur) et **Role** est égal à **FROM**
4. Augmentez **Limit** de 1 à **200** (le maximum)

Cela trouve tous les messages provenant de cette adresse e-mail afin d'obtenir le nombre total.

<Note>
  L'action Search Records est limitée à retourner 200 enregistrements maximum. Cependant, comme vous utilisez uniquement la valeur `totalCount` (et non les enregistrements individuels), cette étape renverra le nombre total d'e-mails envoyés par cette personne.
</Note>

### Étape 4 : Mettre à jour l'enregistrement Person avec une action Create or Update Record

1. Ajoutez une action **Créer ou mettre à jour un enregistrement**

<Warning>
  Utilisez **Créer ou mettre à jour un enregistrement** au lieu de **Mettre à jour un enregistrement** ici. Cela vous permet d'identifier la personne par son adresse e-mail (le champ `handle`) plutôt que d'exiger un ID d'enregistrement d'une étape précédente.
</Warning>

2. Sélectionnez **Personnes** comme objet
3. Recherchez la personne en faisant correspondre son e-mail au `handle` du participant au message
4. Définissez votre champ personnalisé "Nombre d'e-mails reçus" sur `{{searchRecords.totalCount}}`

La valeur `totalCount` de l'action Rechercher des enregistrements représente le nombre total d'e-mails reçus de cette personne.

## Articles connexes

* [Actions de workflows](/l/fr/user-guide/workflows/capabilities/workflow-actions)
* [Comment créer des champs personnalisés](/l/fr/user-guide/data-model/how-tos/customize-your-data-model)
* [Action Search Records](/l/fr/user-guide/workflows/capabilities/workflow-actions#search-records)

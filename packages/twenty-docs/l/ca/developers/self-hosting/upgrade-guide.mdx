---
title: Guia d'actualitzaci贸
image: /images/user-guide/notes/notes_header.png
---

<Frame>
  <img src="/images/user-guide/notes/notes_header.png" alt="Header" />
</Frame>

## Directrius generals

**Always make sure to back up your database before starting the upgrade process** by running `docker exec -it {db_container_name_or_id} pg_dumpall -U {postgres_user} > databases_backup.sql`.

To restore backup, run `cat databases_backup.sql | docker exec -i {db_container_name_or_id} psql -U {postgres_user}`.

Si heu utilitzat Docker Compose, seguiu aquests passos:

1. En un terminal, a l'ordinador on s'executa Twenty, apagueu Twenty: `docker compose down`

2. Actualitzeu la versi贸 canviant el valor `TAG` al fitxer .env prop del vostre docker-compose. (Recomanem utilitzar una versi贸 `major.minor`, com ara `v0.53`)

3. Torneu a posar Twenty en l铆nia amb `docker compose up -d`

Si voleu actualitzar la vostra instncia per unes quantes versions, per exemple, de la v0.33.0 a la v0.35.0, heu d'actualitzar la vostra instncia de manera seq眉encial, en aquest exemple de la v0.33.0 a la v0.34.0, despr茅s de la v0.34.0 a la v0.35.0.

**Assegureu-vos que despr茅s de cada versi贸 actualitzada teniu una c貌pia de seguretat sense corrupci贸.**

## Passos d'actualitzaci贸 espec铆fica de la versi贸

## v1.0

Hola Twenty v1.0! 

## v0.60

### Millores de rendiment

Totes les interaccions amb l'API de metadades s'han optimitzat per a un millor rendiment, especialment per a la manipulaci贸 de metadades d'objectes i operacions de creaci贸 d'espais de treball.

Hem reformat la nostra estrat猫gia de mem貌ria cau per donar prioritat als resultats de la mem貌ria cau davant les consultes a la base de dades quan sigui possible, millorant significativament el rendiment de les operacions de l'API de metadades.

Si trobeu problemes d'execuci贸 despr茅s de l'actualitzaci贸, 茅s possible que hgiu de buidar la mem貌ria cau per assegurar-vos que estigui sincronitzada amb els canvis m茅s recents. Executeu aquesta comanda al vostre contenidor de twenty-server:

```bash
yarn command:prod cache:flush
```

### v0.55

Actualitzeu la vostra instncia de Twenty per utilitzar la imatge v0.55

Ja no necessiteu executar cap comanda, la nova imatge s'encarregar automticament d'executar totes les migracions necessries.

### Error `User does not have permission`

Si trobeu errors d'autoritzaci贸 en la majoria de sol路licituds despr茅s de l'actualitzaci贸, pot ser que hgiu de buidar la mem貌ria cau per recalcular els 煤ltims permisos.

Al vostre contenidor `twenty-server`, executeu:

```bash
yarn command:prod cache:flush
```

Aquest problema 茅s espec铆fic d'aquesta versi贸 de Twenty i no hauria de ser necessari per a actualitzacions futures.

### v0.54

Des de la versi贸 `0.53`, no calen accions manuals.

#### Desactivaci贸 de l'esquema de metadades

Hem fusionat l'esquema `metadata` amb el `core` per simplificar la recuperaci贸 de dades de `TypeORM`.
Hem fusionat el pas de la comanda `migrate` dins de la comanda `upgrade`. No recomanem executar `migrate` manualment en cap dels vostres contenidors de servidor/treballador.

### Des de la v0.53

A partir de `0.53`, l'actualitzaci贸 es fa programticament dins del `DockerFile`, aix貌 vol dir que a partir d'ara, ja no haureu d'executar cap comanda manualment.

Assegureu-vos de continuar actualitzant la vostra instncia seq眉encialment, sense saltar cap versi贸 principal (p. ex. `0.43.3` a `0.44.0` est perm猫s, per貌 `0.43.1` a `0.45.0` no ho est), si no, podria provocar una desincronitzaci贸 de la versi贸 de l'espai de treball que podria resultar en errors d'execuci贸 i funcionalitat perduda.

Per comprovar si un espai de treball s'ha migrat correctament podeu revisar la seva versi贸 a la base de dades a la taula `core.workspace`.

Sempre ha de ser dins del rang de la versi贸 `major.minor` actual de la vostra instncia de Twenty, podeu veure la vostra versi贸 d'instncia al panell d'administraci贸 (a `/settings/admin-panel`, accessible si el vostre usuari t茅 la propietat `canAccessFullAdminPanel` configurada a true a la base de dades) o executant `echo $APP_VERSION` al vostre contenidor `twenty-server`.

Per solucionar una versi贸 desincronitzada de l'espai de treball, haureu d'actualitzar des de la versi贸 corresponent de Twenty seguint la guia d'actualitzaci贸 relacionada de manera seq眉encial fins que arribi a la versi贸 desitjada.

#### Eliminaci贸 de `auditLog`

Hem eliminat l'objecte estndard auditLog, el que significa que la mida de la vostra c貌pia de seguretat podria reduir-se significativament despr茅s d'aquesta migraci贸.

### v0.51 a v0.52

Actualitzeu la vostra instncia de Twenty per utilitzar la imatge v0.52

```
yarn database:migrate:prod
yarn command:prod upgrade
```

#### Tinc un espai de treball bloquejat a la versi贸 entre `0.52.0` i `0.52.6`

Malauradament, `0.52.0` i `0.52.6` han estat completament eliminats de dockerHub.
Haureu d'actualitzar manualment la versi贸 del vostre espai de treball a la `0.51.0` a la base de dades i actualitzar utilitzant la versi贸 de Twenty `0.52.11` seguint just per sobre de la seva guia d'actualitzaci贸.

### v0.50 a v0.51

Actualitzeu la vostra instncia de Twenty per utilitzar la imatge v0.51

```
yarn database:migrate:prod
yarn command:prod upgrade
```

### v0.44.0 a v0.50.0

Actualitzeu la vostra instncia de Twenty per utilitzar la imatge v0.50.0

```
yarn database:migrate:prod
yarn command:prod upgrade
```

#### Mutaci贸 de Docker-compose.yml

Aquesta versi贸 inclou una mutaci贸 de `docker-compose.yml` per donar acc茅s al servei `worker` al volum `server-local-data`.
Si us plau, actualitzeu el vostre `docker-compose.yml` local amb el [v0.50.0 docker-compose.yml](https://github.com/twentyhq/twenty/blob/v0.50.0/packages/twenty-docker/docker-compose.yml)

### v0.43.0 a v0.44.0

Actualitzeu la vostra instncia de Twenty per utilitzar la imatge v0.44.0

```
yarn database:migrate:prod
yarn command:prod upgrade
```

### v0.42.0 a v0.43.0

Actualitzeu la vostra instncia de Twenty per utilitzar la imatge v0.43.0

```
yarn database:migrate:prod
yarn command:prod upgrade
```

En aquesta versi贸, tamb茅 hem canviat a la imatge postgres:16 al docker-compose.yml.

#### (Opci贸 1) Migraci贸 de base de dades

Mantenir l'imatge postgres-spilo existent 茅s correcte, per貌 haureu de congelar la versi贸 al vostre docker-compose.yml a 0.43.0.

#### (Opci贸 2) Migraci贸 de base de dades

Si voleu migrar la vostra base de dades a la nova imatge postgres:16, seguiu els passos seg眉ents:

1. Descarregueu la vostra base de dades del contenidor antic de postgres-spilo

```
docker exec -it twenty-db-1 sh
pg_dump -U {YOUR_POSTGRES_USER} -d {YOUR_POSTGRES_DB} > databases_backup.sql
exit
docker cp twenty-db-1:/home/postgres/databases_backup.sql .
```

Assegureu-vos que el fitxer de c貌pia de seguretat no estigui buit.

2. Actualitzeu el vostre docker-compose.yml per utilitzar la imatge postgres:16 tal com es mostra al fitxer [docker-compose.yml](https://raw.githubusercontent.com/twentyhq/twenty/main/packages/twenty-docker/docker-compose.yml).

3. Restaura la base de dades al nou contenidor de postgres:16

```
docker cp databases_backup.sql twenty-db-1:/databases_backup.sql
docker exec -it twenty-db-1 sh
psql -U {YOUR_POSTGRES_USER} -d {YOUR_POSTGRES_DB} -f databases_backup.sql
exit
```

### v0.41.0 a v0.42.0

Actualitzeu la vostra instncia de Twenty per utilitzar la imatge v0.42.0

```
yarn database:migrate:prod
yarn command:prod upgrade-0.42
```

**Variables d'entorn**

- Eliminat: `FRONT_PORT`, `FRONT_PROTOCOL`, `FRONT_DOMAIN`, `PORT`
- Afegit: `FRONTEND_URL`, `NODE_PORT`, `MAX_NUMBER_OF_WORKSPACES_DELETED_PER_EXECUTION`, `MESSAGING_PROVIDER_MICROSOFT_ENABLED`, `CALENDAR_PROVIDER_MICROSOFT_ENABLED`, `IS_MICROSOFT_SYNC_ENABLED`

### v0.40.0 a v0.41.0

Actualitzeu la vostra instncia de Twenty per utilitzar la imatge v0.41.0

```
yarn database:migrate:prod
yarn command:prod upgrade-0.41
```

**Variables d'entorn**

- Eliminat: `AUTH_MICROSOFT_TENANT_ID`

### v0.35.0 a v0.40.0

Actualitzeu la vostra instncia de Twenty per utilitzar la imatge v0.40.0

```
yarn database:migrate:prod
yarn command:prod upgrade-0.40
```

**Variables d'entorn**

- Afegit: `IS_EMAIL_VERIFICATION_REQUIRED`, `EMAIL_VERIFICATION_TOKEN_EXPIRES_IN`, `WORKFLOW_EXEC_THROTTLE_LIMIT`, `WORKFLOW_EXEC_THROTTLE_TTL`

### v0.34.0 a v0.35.0

Actualitzeu la vostra instncia de Twenty per utilitzar la imatge v0.35.0

```
yarn database:migrate:prod
yarn command:prod upgrade-0.35
```

La comanda `yarn database:migrate:prod` aplicar les migracions a l'estructura de la base de dades (esquemes core i metadata)
La comanda `yarn command:prod upgrade-0.35` s'encarrega de la migraci贸 de dades de tots els espais de treball.

**Variables d'entorn**

- Hem substitu茂t `ENABLE_DB_MIGRATIONS` per `DISABLE_DB_MIGRATIONS` (el valor per defecte ara 茅s `false`, probablement no haureu de configurar res)

### v0.33.0 a v0.34.0

Actualitzeu la vostra instncia de Twenty per utilitzar la imatge v0.34.0

```
yarn database:migrate:prod
yarn command:prod upgrade-0.34
```

La comanda `yarn database:migrate:prod` aplicar les migracions a l'estructura de la base de dades (esquemes core i metadata)
La comanda `yarn command:prod upgrade-0.34` s'encarrega de la migraci贸 de dades de tots els espais de treball.

**Variables d'entorn**

- Eliminat: `FRONT_BASE_URL`
- Afegit: `FRONT_DOMAIN`, `FRONT_PROTOCOL`, `FRONT_PORT`

Hem actualitzat la manera com gestionem l'URL del frontend.
Ara podeu definir l'URL del frontend utilitzant les variables `FRONT_DOMAIN`, `FRONT_PROTOCOL` i `FRONT_PORT`.
Si no es defineix FRONT_DOMAIN, l'URL del frontend es revertir a `SERVER_URL`.

### v0.32.0 a v0.33.0

Actualitzeu la vostra instncia de Twenty per utilitzar la imatge v0.33.0

```
yarn command:prod cache:flush
yarn database:migrate:prod
yarn command:prod upgrade-0.33
```

La comanda `yarn command:prod cache:flush` buidar la mem貌ria cau de Redis.
La comanda `yarn database:migrate:prod` aplicar les migracions a l'estructura de la base de dades (esquemes core i metadata)
La comanda `yarn command:prod upgrade-0.33` s'encarrega de la migraci贸 de dades de tots els espais de treball.

A partir d'aquesta versi贸, la imatge de twenty-postgres per a la base de dades es va deprecar i s'utilitza la twenty-postgres-spilo.
Si voleu continuar utilitzant la imatge de twenty-postgres, simplement substitu茂u `twentycrm/twenty-postgres:${TAG}` per `twentycrm/twenty-postgres` a docker-compose.yml.

### v0.31.0 a v0.32.0

Actualitzeu la vostra instncia de Twenty per utilitzar la imatge v0.32.0

**Migraci贸 d'esquema i dades**

```
yarn database:migrate:prod
yarn command:prod upgrade-0.32
```

La comanda `yarn database:migrate:prod` aplicar les migracions a l'estructura de la base de dades (esquemes core i metadata)
La comanda `yarn command:prod upgrade-0.32` s'encarrega de la migraci贸 de dades de tots els espais de treball.

**Variables d'entorn**

Hem actualitzat la manera com gestionem la connexi贸 de Redis.

- Eliminat: `REDIS_HOST`, `REDIS_PORT`, `REDIS_USERNAME`, `REDIS_PASSWORD`
- Afegit: `REDIS_URL`

Actualitzeu el vostre fitxer .env per utilitzar la nova variable `REDIS_URL` en lloc dels parmetres de connexi贸 de Redis individuals.

Tamb茅 hem simplificat la manera en qu猫 gestionem els tokens JWT.

- Eliminat: `ACCESS_TOKEN_SECRET`, `LOGIN_TOKEN_SECRET`, `REFRESH_TOKEN_SECRET`, `FILE_TOKEN_SECRET`
- Afegit: `APP_SECRET`

Actualitzeu el vostre fitxer .env per utilitzar la nova variable `APP_SECRET` en lloc dels secrets individuals de tokens (podeu utilitzar el mateix secret que abans o generar un nou cadenat aleatori)

**Compte connectat**

Si esteu utilitzant un compte connectat per sincronitzar els vostres correus electr貌nics i calendaris de Google, haureu d'activar l'[API de persones](https://developers.google.com/people) al vostre Google Admin console.

### v0.30.0 a v0.31.0

Actualitzeu la vostra instncia de Twenty per utilitzar la imatge v0.31.0

**Migraci贸 d'esquema i dades**:

```
yarn database:migrate:prod
yarn command:prod upgrade-0.31
```

La comanda `yarn database:migrate:prod` aplicar les migracions a l'estructura de la base de dades (esquemes core i metadata)
La comanda `yarn command:prod upgrade-0.31` s'encarrega de la migraci贸 de dades de tots els espais de treball.

### v0.24.0 a v0.30.0

Actualitzeu la vostra instncia de Twenty per utilitzar la imatge v0.30.0

**Breaking change**:
To enhance performances, Twenty now requires redis cache to be configured. Hem actualitzat el nostre [docker-compose.yml](https://raw.githubusercontent.com/twentyhq/twenty/main/packages/twenty-docker/docker-compose.yml) per reflectir aix貌.
Assegureu-vos d'actualitzar la vostra configuraci贸 i actualitzar les vostres variables d'entorn en conseq眉猫ncia:

```
REDIS_HOST={your-redis-host}
REDIS_PORT={your-redis-port}
CACHE_STORAGE_TYPE=redis
```

**Migraci贸 d'esquema i dades**:

```
yarn database:migrate:prod
yarn command:prod upgrade-0.30
```

La comanda `yarn database:migrate:prod` aplicar les migracions a l'estructura de la base de dades (esquemes core i metadata)
La comanda `yarn command:prod upgrade-0.30` s'encarrega de la migraci贸 de dades de tots els espais de treball.

### v0.23.0 a v0.24.0

Actualitzeu la vostra instncia de Twenty per utilitzar la imatge v0.24.0

Executeu les seg眉ents comandes:

```
yarn database:migrate:prod
yarn command:prod upgrade-0.24
```

La comanda `yarn database:migrate:prod` aplicar les migracions a l'estructura de la base de dades (esquemes core i metadata)
La comanda `yarn command:prod upgrade-0.24` s'encarrega de la migraci贸 de dades de tots els espais de treball.

### v0.22.0 a v0.23.0

Actualitzeu la vostra instncia de Twenty per utilitzar la imatge v0.23.0

Executeu les seg眉ents comandes:

```
yarn database:migrate:prod
yarn command:prod upgrade-0.23
```

La comanda `yarn database:migrate:prod` aplicar les migracions a la base de dades.
La comanda `yarn command:prod upgrade-0.23` s'encarrega de la migraci贸 de dades, incloent la transfer猫ncia d'activitats a tasques/notes.

### v0.21.0 a v0.22.0

Actualitzeu la vostra instncia de Twenty per utilitzar la imatge v0.22.0

Executeu les seg眉ents comandes:

```
yarn database:migrate:prod
yarn command:prod workspace:sync-metadata -f
yarn command:prod upgrade-0.22
```

La comanda `yarn database:migrate:prod` aplicar les migracions a la base de dades.
La comanda `yarn command:prod workspace:sync-metadata -f` sincronitzar la definici贸 d'objectes estndard amb les taules de metadades i aplicar les migracions necessries als espais de treball existents.
La comanda `yarn command:prod upgrade-0.22` aplicar transformacions de dades espec铆fiques per adaptar-se a les noves opcions per defecte d'instrumentaci贸 de sol路licituds de l'objecte.





---
title: 文件夹架构
info: 详细了解我们的服务器文件夹架构
---

后端目录结构如下：

```
server
  └───能力
  └───常量
  └───核心
  └───数据库
  └───装饰器
  └───过滤器
  └───守卫
  └───健康
  └───集成
  └───元数据
  └───工作空间
  └───工具
```

## 能力

定义权限并为每个实体提供处理程序。

## 装饰器

为增强功能在NestJS中定义自定义装饰器。

有关更多详细信息，请参阅[自定义装饰器](https://docs.nestjs.com/custom-decorators)。

## 过滤器

包含异常过滤器，以处理可能在GraphQL端点中出现的异常。

## 守卫

有关更多详细信息，请参见[守卫](https://docs.nestjs.com/guards)。

## 健康

包含一个公开可用的REST API（healthz），返回JSON以确认数据库是否按预期工作。

## 元数据

定义自定义对象并提供GraphQL API（graphql/metadata）。

## 工作区

生成并提供基于元数据的自定义GraphQL架构。

### 工作空间目录结构

```
workspace

  └───workspace-schema-builder
    └───工厂
    └───graphql类型
    └───数据库
    └───接口
    └───对象定义
    └───服务
    └───存储
    └───工具
  └───workspace-resolver-builder
    └───工厂
    └───接口
  └───workspace-query-builder
    └───工厂
    └───接口
  └───workspace-query-runner
    └───接口
    └───工具
  └───workspace-datasource
  └───workspace-manager
  └───workspace-migration-runner
  └───工具
  └───workspace.module.ts
  └───workspace.factory.spec.ts
  └───workspace.factory.ts
```

工作空间目录的根目录包含`workspace.factory.ts`，其中包含`createGraphQLSchema`函数。 此函数通过使用元数据为各个工作空间定制架构来生成工作空间特定的架构。 通过分离架构和解析程序的构建，我们使用`makeExecutableSchema`函数，该函数结合这些离散元素。

这个策略不仅仅是关于组织，它还有助于优化，比如缓存生成的类型定义以提高性能和可扩展性。

### 工作空间架构生成器

生成GraphQL架构，并包括：

#### 工厂：

专门的构造函数用于生成与GraphQL相关的结构。

* type.factory使用`TypeMapperService`将字段元数据翻译为GraphQL类型。
* type-definition.factory创建从`objectMetadata`派生的GraphQL输入或输出对象。

#### GraphQL类型

包括枚举、输入、对象和标量，并作为架构构建的基石。

#### 接口和对象定义

包含GraphQL实体的蓝图，包括诸如`MONEY`或`URL`之类的预定义和自定义类型。

#### 服务

包含负责将FieldMetadataType与其适当GraphQL标量或查询修饰符相关联的服务。

#### 存储

包含`TypeDefinitionsStorage`类，其中包含可重用的类型定义，防止重复GraphQL类型。

### 工作空间解析器生成器

创建用于查询和修改GraphQL架构的解析器函数。

此目录中的每个工厂负责生成不同类型的解析器，如`FindManyResolverFactory`，旨在跨各种表灵活应用。

### 工作空间查询运行器

在数据库上运行生成的查询并解析结果。

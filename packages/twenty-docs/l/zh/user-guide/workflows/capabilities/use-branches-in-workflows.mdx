---
title: 在工作流中使用分支
description: 了解分支如何工作，以及如何控制执行哪条路径。
---

## 分支的工作方式

在工作流编辑器中，您可以从单个节点延伸出多条路径（分支）。 这使您能够构建具有不同结果的复杂自动化流程。

**重要**：当工作流运行时，默认情况下**所有分支都会并行执行**。 没有内置的 "if/else" 逻辑来在分支间做出选择——每条路径都会同时运行。

## 控制执行哪个分支

若要根据特定条件仅执行一个分支，**在每个分支的开头添加一个 Filter 节点**。

### 示例设置

1. 从单个节点创建包含多个分支的工作流
2. 在每个分支的第一步添加一个**Filter** 节点
3. 在每个 Filter 上设置条件，以确定该分支何时继续
4. 只有满足其 Filter 条件的分支会继续

<img src="/images/user-guide/workflows/branches-with-filters.png" style={{width:'100%'}} />

### Filter 的工作方式

* 如果 Filter 条件被**满足**：该分支继续执行
* 如果 Filter 条件**未满足**：该分支会在 Filter 节点停止

这实际上创建了条件逻辑，使只有与您的数据相匹配的合适分支会运行。

## 示例：按交易金额路由

**场景**：当交易达成时，根据交易金额发送不同的通知。

1. **触发器**：Opportunity 已更新（Stage = Closed Won）
2. **分支 1**：Filter 条件：Amount > $10,000 → 向 #big-deals 发送 Slack 消息
3. **分支 2**：Filter 条件：Amount ≤ $10,000 → 向销售经理发送电子邮件

两个分支都会启动，但只有与交易金额匹配的分支会通过其 Filter 继续执行。

## 创建分支

<Note>
  要从现有步骤创建新分支，请点击该步骤上的 **+** 按钮并添加您的操作。 您可以多次点击 **+** 来添加多个分支。
</Note>

1. 在工作流编辑器中，选择您想要从其分支出去的步骤
2. 点击 **+** 以添加一个操作
3. 这将创建一个分支
4. 在同一步骤上再次点击 **+** 以创建更多分支
5. 每个分支都可以拥有自己的一系列操作

## 合并分支

并行分支完成其工作后，您可以将它们合并回单一路径：

1. 完成您的分支内操作
2. 在所有分支之后添加一个应运行的新步骤
3. 将每个分支末端的连接拖拽到这个新步骤
4. 合并后的步骤会在所有连接的分支完成后才执行

### 示例：先处理后通知

```
触发器
   │
   ├── 分支 A：更新客户记录
   │
   └── 分支 B：创建支持工单

       ↘  ↙

   合并步骤：发送确认电子邮件
```

仅在客户更新和工单创建都完成后才会发送确认电子邮件。

## 最佳实践

* 当您需要条件执行时，请始终在分支开始处使用**Filter 节点**
* 使分支条件**互斥**，以避免重复操作
* 使用不同数据测试您的工作流，以确保运行正确的分支
* **重命名分支步骤**，使每条路径的作用清晰明了
* **合并分支**，当您在并行处理后需要执行最终操作时

## 相关内容

* [工作流常见问题](/l/zh/user-guide/workflows/how-tos/need-more-help/workflows-faq) — 关于并行执行的解答
* [工作流操作](/l/zh/user-guide/workflows/capabilities/workflow-actions) — 分支可用的操作

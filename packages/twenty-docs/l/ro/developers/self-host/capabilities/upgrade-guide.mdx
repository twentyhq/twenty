---
title: Ghid de actualizare
---

## General guidelines

**Always make sure to back up your database before starting the upgrade process** by running `docker exec -it {db_container_name_or_id} pg_dumpall -U {postgres_user} > databases_backup.sql`.

To restore backup, run `cat databases_backup.sql | docker exec -i {db_container_name_or_id} psql -U {postgres_user}`.

Dac캒 a탵i utilizat Docker Compose, urma탵i ace탳ti pa탳i:

1. 칉ntr-un terminal, pe g캒zduitorul unde ruleaz캒 Twenty, opri탵i Twenty: `docker compose down`.

2. Actualiza탵i versiunea modific칙nd valoarea `TAG` din fi탳ierul .env 칥n apropierea docker-compose-ului. ( We recommend consuming `major.minor` version such as `v0.53` )

3. Repune탵i Twenty 칥n func탵iune cu comanda `docker compose up -d`.

Dac캒 dori탵i s캒 actualiza탵i instan탵a dvs. cu c칙teva versiuni, de exemplu de la v0.33.0 la v0.35.0, trebuie s캒 actualiza탵i instan탵a dvs. secven탵ial, 칥n acest exemplu de la v0.33.0 la v0.34.0, apoi de la v0.34.0 la v0.35.0.

**Asigura탵i-v캒 c캒 dup캒 fiecare actualizare de versiune ave탵i un backup necorupt.**

## Pa탳i de actualizare specifici versiunii

## v1.0

Salut Twenty v1.0! 游꿀

## v0.60

### 칉mbun캒t캒탵iri de performan탵캒

Toate interac탵iunile cu API-ul de metadata au fost optimizate pentru o performan탵캒 mai bun캒, 칥n special pentru manipularea metadata-ului obiectelor 탳i opera탵iile de creare a spa탵iilor de lucru.

Am ref캒cut strategia de caching pentru a prioritiza acces캒rile din cache 칥n detrimentul interog캒rilor c캒tre baza de date, 칥mbun캒t캒탵ind semnificativ performan탵a opera탵iunilor API-ului de metadata.

Dac캒 칥nt칙mpina탵i probleme de runtime dup캒 actualizare, s-ar putea s캒 fie nevoie s캒 goli탵i cache-ul pentru a v캒 asigura c캒 este sincronizat cu ultimele schimb캒ri. Rula탵i aceast캒 comand캒 칥n containerul dvs. twenty-server:

```bash
yarn command:prod cache:flush
```

### v0.55

Actualiza탵i instan탵a Twenty pentru a utiliza imaginea v0.55

Nu este necesar s캒 mai rula탵i nici o comand캒, noua imagine se va ocupa automat de rularea tuturor migra탵iilor necesare.

### Eroare `Utilizatorul nu are permisiune`

Dac캒 칥nt칙mpina탵i erori de autorizare la majoritatea cererilor dup캒 actualizare, s-ar putea s캒 fie nevoie s캒 goli탵i cache-ul pentru a recalcula permisiunile actualizate.

칉n containerul dvs. `twenty-server`, rula탵i:

```bash
yarn command:prod cache:flush
```

Aceast캒 problem캒 este specific캒 versiunii Twenty 탳i nu ar trebui s캒 fie necesar캒 pentru actualiz캒rile viitoare.

### v0.54

칉ncep칙nd cu versiunea `0.53`, nu sunt necesare ac탵iuni manuale.

#### Dep캒탳irea schemelor de metadata

Am combinat schema `metadata` cu cea `core` pentru a simplifica extragerea datelor din `TypeORM`.
Am 칥mbinat pasul de comand캒 `migrate` 칥n cadrul comenzii `upgrade`. Nu recomand캒m rularea manual캒 a comenzii `migrate` 칥n oricare dintre containerele dvs. server/worker.

### 칉ncep칙nd cu v0.53

칉ncep칙nd cu `0.53`, actualizarea se face programatic 칥n cadrul `DockerFile`, ceea ce 칥nseamn캒 c캒 de acum nu ar trebui s캒 mai fie necesar s캒 rula탵i manual nici o comand캒.

Asigura탵i-v캒 c캒 v캒 actualiza탵i instan탵a secven탵ial, f캒r캒 a s캒ri peste nicio versiune major캒 (de exemplu, `0.43.3` to `0.44.0` este permis, dar `0.43.1` to `0.45.0` nu este), altfel ar putea duce la desincronizare a versiunii spa탵iului de lucru, care ar putea rezulta 칥n erori de runtime 탳i func탵ionalit캒탵i lips캒.

Pentru a verifica dac캒 un spa탵iu de lucru a fost migrat corect, pute탵i verifica versiunea acestuia 칥n baza de date 칥n tabelul `core.workspace`.

Ar trebui s캒 fie mereu 칥n intervalul versiunii Twenty curente `major.minor`, pute탵i vizualiza versiunea instan탵ei dvs. 칥n panoul de administrare (la `/settings/admin-panel`, accesibil dac캒 utilizatorul dvs. are proprietatea `canAccessFullAdminPanel` setat캒 la adev캒rat 칥n baza de date) sau execut칙nd `echo $APP_VERSION` 칥n containerul dvs. `twenty-server`.

Pentru a remedia o desincronizare a versiunii spa탵iului de lucru, va trebui s캒 actualiza탵i din versiunea corespunz캒toare Twenty urm칙nd ghidul de actualizare relevant secven탵ial 탳i a탳a mai departe p칙n캒 c칙nd ajunge탵i la versiunea dorit캒.

#### Eliminarea `auditLog`

Am eliminat obiectul standard auditLog, ceea ce 칥nseamn캒 c캒 dimensiunea backup-ului dvs. ar putea fi redus캒 semnificativ dup캒 aceast캒 migra탵ie.

### v0.51 la v0.52

Actualiza탵i instan탵a Twenty pentru a utiliza imaginea v0.52

```
yarn database:migrate:prod
yarn command:prod upgrade
```

#### Am un spa탵iu de lucru blocat 칥n versiunea 칥ntre `0.52.0` 탳i `0.52.6`.

Din p캒cate, `0.52.0` 탳i `0.52.6` au fost complet eliminate din dockerHub.
Va trebui s캒 actualiza탵i manual versiunea spa탵iului de lucru la `0.51.0` 칥n baza de date 탳i s캒 actualiza탵i utiliz칙nd versiunea twenty `0.52.11` urm칙nd ghidul de actualizare de mai sus.

### v0.50 la v0.51

Actualiza탵i instan탵a Twenty pentru a utiliza imaginea v0.51

```
yarn database:migrate:prod
yarn command:prod upgrade
```

### v0.44.0 la v0.50.0

Actualiza탵i instan탵a Twenty pentru a utiliza imaginea v0.50.0

```
yarn database:migrate:prod
yarn command:prod upgrade
```

#### Mutarea docker-compose.yml

Aceast캒 versiune include o muta탵ie `docker-compose.yml` pentru a oferi serviciului `worker` acces la volumul `server-local-data`.
V캒 rug캒m s캒 actualiza탵i docker-compose.yml-ul dvs. local cu [v0.50.0 docker-compose.yml](https://github.com/twentyhq/twenty/blob/v0.50.0/packages/twenty-docker/docker-compose.yml)

### v0.43.0 la v0.44.0

Actualiza탵i instan탵a Twenty pentru a utiliza imaginea v0.44.0

```
yarn database:migrate:prod
yarn command:prod upgrade
```

### v0.42.0 la v0.43.0

Actualiza탵i instan탵a Twenty pentru a utiliza imaginea v0.43.0

```
yarn database:migrate:prod
yarn command:prod upgrade
```

칉n aceast캒 versiune, am trecut 탳i la imaginea postgres:16 칥n docker-compose.yml.

#### (Op탵iunea 1) Migrarea bazei de date

P캒strarea imaginii existente postgres-spilo este adecvat캒, 칥ns캒 va trebui s캒 congela탵i versiunea 칥n docker-compose.yml la 0.43.0.

#### (Op탵iunea 2) Migrarea bazei de date

Dac캒 dori탵i s캒 migra탵i baza de date la noua imagine postgres:16, urma탵i ace탳ti pa탳i:

1. Copie탵i baza de date din vechiul container postgres-spilo

```
docker exec -it twenty-db-1 sh
pg_dump -U {YOUR_POSTGRES_USER} -d {YOUR_POSTGRES_DB} > databases_backup.sql
exit
docker cp twenty-db-1:/home/postgres/databases_backup.sql .
```

Asigura탵i-v캒 c캒 fi탳ierul de backup nu este gol.

2. Actualiza탵i docker-compose.yml-ul pentru a utiliza imaginea postgres:16 din fi탳ierul [docker-compose.yml](https://raw.githubusercontent.com/twentyhq/twenty/main/packages/twenty-docker/docker-compose.yml).

3. Restaura탵i baza de date 칥n noul container postgres:16

```
docker cp databases_backup.sql twenty-db-1:/databases_backup.sql
docker exec -it twenty-db-1 sh
psql -U {YOUR_POSTGRES_USER} -d {YOUR_POSTGRES_DB} -f databases_backup.sql
exit
```

### v0.41.0 la v0.42.0

Actualiza탵i instan탵a Twenty pentru a utiliza imaginea v0.42.0

```
yarn database:migrate:prod
yarn command:prod upgrade-0.42
```

**Variabile de mediu**

* Eliminat: `FRONT_PORT`, `FRONT_PROTOCOL`, `FRONT_DOMAIN`, `PORT`
* Ad캒ugat: `FRONTEND_URL`, `NODE_PORT`, `MAX_NUMBER_OF_WORKSPACES_DELETED_PER_EXECUTION`, `MESSAGING_PROVIDER_MICROSOFT_ENABLED`, `CALENDAR_PROVIDER_MICROSOFT_ENABLED`, `IS_MICROSOFT_SYNC_ENABLED`

### v0.40.0 la v0.41.0

Actualiza탵i instan탵a Twenty pentru a utiliza imaginea v0.41.0

```
yarn database:migrate:prod
yarn command:prod upgrade-0.41
```

**Variabile de mediu**

* Eliminat: `AUTH_MICROSOFT_TENANT_ID`

### v0.35.0 la v0.40.0

Actualiza탵i instan탵a Twenty pentru a utiliza imaginea v0.40.0

```
yarn database:migrate:prod
yarn command:prod upgrade-0.40
```

**Variabile de mediu**

* Ad캒ugat: `IS_EMAIL_VERIFICATION_REQUIRED`, `EMAIL_VERIFICATION_TOKEN_EXPIRES_IN`, `WORKFLOW_EXEC_THROTTLE_LIMIT`, `WORKFLOW_EXEC_THROTTLE_TTL`

### v0.34.0 la v0.35.0

Actualiza탵i instan탵a Twenty pentru a utiliza imaginea v0.35.0

```
yarn database:migrate:prod
yarn command:prod upgrade-0.35
```

Comanda `yarn database:migrate:prod` va aplica migra탵iile pe structura bazei de date (schemele de core 탳i metadata)
Comanda `yarn command:prod upgrade-0.35` se ocup캒 de migra탵ia datelor pentru toate spa탵iile de lucru.

**Variabile de mediu**

* Am 칥nlocuit `ENABLE_DB_MIGRATIONS` cu `DISABLE_DB_MIGRATIONS` (valoarea standard este acum `false`, probabil nu va trebui s캒 seta탵i nimic)

### v0.33.0 la v0.34.0

Actualiza탵i instan탵a Twenty pentru a utiliza imaginea v0.34.0

```
yarn database:migrate:prod
yarn command:prod upgrade-0.34
```

Comanda `yarn database:migrate:prod` va aplica migra탵iile pe structura bazei de date (schemele core 탳i metadata)
Comanda `yarn command:prod upgrade-0.34` se ocup캒 de migra탵ia datelor pentru toate spa탵iile de lucru.

**Variabile de mediu**

* Eliminat: `FRONT_BASE_URL`
* Ad캒ugat: `FRONT_DOMAIN`, `FRONT_PROTOCOL`, `FRONT_PORT`

Am actualizat modul 칥n care gestion캒m URL-ul frontend.
Acum pute탵i seta URL-ul frontend utiliz칙nd variabilele `FRONT_DOMAIN`, `FRONT_PROTOCOL` 탳i `FRONT_PORT`.
Dac캒 FRONT_DOMAIN nu este setat, URL-ul frontend va reveni la `SERVER_URL`.

### v0.32.0 la v0.33.0

Actualiza탵i instan탵a Twenty pentru a utiliza imaginea v0.33.0

```
yarn command:prod cache:flush
yarn database:migrate:prod
yarn command:prod upgrade-0.33
```

Comanda `yarn command:prod cache:flush` va goli cache-ul Redis.
Comanda `yarn database:migrate:prod` va aplica migra탵iile pe structura bazei de date (schemele core 탳i metadata)
Comanda `yarn command:prod upgrade-0.33` se ocup캒 de migra탵ia datelor pentru toate spa탵iile de lucru.

칉ncep칙nd cu aceast캒 versiune, imaginea twenty-postgres pentru DB a devenit dep캒탳it캒 탳i se utilizeaz캒 twenty-postgres-spilo.
Dac캒 dori탵i s캒 p캒stra탵i utilizarea imaginii twenty-postgres, 칥nlocui탵i pur 탳i simplu `twentycrm/twenty-postgres:${TAG}` cu `twentycrm/twenty-postgres` 칥n docker-compose.yml.

### v0.31.0 la v0.32.0

Actualiza탵i instan탵a Twenty pentru a utiliza imaginea v0.32.0

**Migrarea schemelor 탳i datelor**

```
yarn database:migrate:prod
yarn command:prod upgrade-0.32
```

Comanda `yarn database:migrate:prod` va aplica migra탵iile pe structura bazei de date (schemele core 탳i metadata)
Comanda `yarn command:prod upgrade-0.32` se ocup캒 de migra탵ia datelor pentru toate spa탵iile de lucru.

**Variabile de mediu**

Am actualizat modul 칥n care gestion캒m conexiunea Redis.

* Eliminat: `REDIS_HOST`, `REDIS_PORT`, `REDIS_USERNAME`, `REDIS_PASSWORD`
* Ad캒ugat: `REDIS_URL`

Actualiza탵i fi탳ierul `.env` pentru a utiliza noua variabil캒 `REDIS_URL` 칥n locul parametrilor individuali de conexiune Redis.

Am simplificat, de asemenea, modul 칥n care gestion캒m jetoanele JWT.

* Eliminat: `ACCESS_TOKEN_SECRET`, `LOGIN_TOKEN_SECRET`, `REFRESH_TOKEN_SECRET`, `FILE_TOKEN_SECRET`
* Ad캒ugat: `APP_SECRET`

Actualiza탵i fi탳ierul `.env` pentru a utiliza noua variabil캒 `APP_SECRET` 칥n locul secretelor individuale ale tokenurilor (pute탵i folosi acela탳i secret ca 탳i 칥nainte sau genera탵i unul nou aleator).

**Cont conectat**

Dac캒 utiliza탵i un cont conectat pentru a sincroniza emailurile 탳i calendarele Google, va trebui s캒 activa탵i [People API](https://developers.google.com/people) 칥n consola dvs. Google Admin.

### v0.30.0 la v0.31.0

Actualiza탵i instan탵a Twenty pentru a utiliza imaginea v0.31.0

**Migrarea schemelor 탳i datelor**:

```
yarn database:migrate:prod
yarn command:prod upgrade-0.31
```

Comanda `yarn database:migrate:prod` va aplica migra탵iile pe structura bazei de date (schemele core 탳i metadata)
Comanda `yarn command:prod upgrade-0.31` se ocup캒 de migra탵ia datelor pentru toate spa탵iile de lucru.

### v0.24.0 la v0.30.0

Actualiza탵i instan탵a Twenty pentru a utiliza imaginea v0.30.0

**Breaking change**:
To enhance performances, Twenty now requires redis cache to be configured. Am actualizat [docker-compose.yml](https://raw.githubusercontent.com/twentyhq/twenty/main/packages/twenty-docker/docker-compose.yml) pentru a reflecta acest lucru.
Asigura탵i-v캒 c캒 v캒 actualiza탵i configura탵ia 탳i actualiza탵i variabilele de mediu corespunz캒tor:

```
REDIS_HOST={your-redis-host}
REDIS_PORT={your-redis-port}
CACHE_STORAGE_TYPE=redis
```

**Migrarea schemelor 탳i datelor**:

```
yarn database:migrate:prod
yarn command:prod upgrade-0.30
```

Comanda `yarn database:migrate:prod` va aplica migra탵iile pe structura bazei de date (schemele core 탳i metadata)
Comanda `yarn command:prod upgrade-0.30` se ocup캒 de migra탵ia datelor pentru toate spa탵iile de lucru.

### v0.23.0 la v0.24.0

Actualiza탵i instan탵a Twenty pentru a utiliza imaginea v0.24.0

Rula탵i urm캒toarele comenzi:

```
yarn database:migrate:prod
yarn command:prod upgrade-0.24
```

Comanda `yarn database:migrate:prod` va aplica migra탵iile pe structura bazei de date (schemele core 탳i metadata)
Comanda `yarn command:prod upgrade-0.24` se ocup캒 de migra탵ia datelor pentru toate spa탵iile de lucru.

### v0.22.0 la v0.23.0

Actualiza탵i instan탵a Twenty pentru a utiliza imaginea v0.23.0

Rula탵i urm캒toarele comenzi:

```
yarn database:migrate:prod
yarn command:prod upgrade-0.23
```

Comanda `yarn database:migrate:prod` va aplica migra탵iile pe baza de date.
Comanda `yarn command:prod upgrade-0.23` se ocup캒 de migra탵ia datelor, inclusiv transferul activit캒탵ilor c캒tre sarcini/note.

### v0.21.0 la v0.22.0

Actualiza탵i instan탵a Twenty pentru a utiliza imaginea v0.22.0

Rula탵i urm캒toarele comenzi:

```
yarn database:migrate:prod
yarn command:prod workspace:sync-metadata -f
yarn command:prod upgrade-0.22
```

Comanda `yarn database:migrate:prod` va aplica migra탵iile pe baza de date.
Comanda `yarn command:prod workspace:sync-metadata -f` va sincroniza defini탵ia obiectelor standard cu tabelele de metadate 탳i va aplica migra탵iile necesare 칥n spa탵iile de lucru existente.
Comanda `yarn command:prod upgrade-0.22` va aplica transform캒ri specifice de date pentru a se adapta la noile op탵iuni defaultRequestInstrumentationOptions ale obiectului.

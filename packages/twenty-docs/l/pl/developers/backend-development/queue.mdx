---
title: Kolejka komunikatów
image: /images/user-guide/emails/emails_header.png
---

<Frame>
  <img src="/images/user-guide/emails/emails_header.png" alt="Header" />
</Frame>

Kolejki ułatwiają wykonywanie operacji asynchronicznych. Mogą być używane do realizacji zadań w tle, takich jak wysłanie powitalnego e-maila przy rejestracji.
Każdy przypadek użycia będzie miał własną klasę kolejki rozszerzoną z `MessageQueueServiceBase`.

Obecnie obsługujemy tylko `bull-mq`[bull-mq](https://bullmq.io/) jako sterownik kolejki.

## Kroki tworzenia i używania nowej kolejki

1. Dodaj nazwę kolejki dla swojej nowej kolejki w enum `MESSAGE_QUEUES`.
2. Zapewnij implementację fabryki kolejki z nazwą kolejki jako tokenem zależności.
3. Wstrzyknij utworzoną kolejkę w odpowiednim module/usłudze z nazwą kolejki jako tokenem zależności.
4. Dodaj klasę pracownika z wstrzykiwaniem opartym na tokenie tak jak w przypadku producenta.

### Przykład użycia

```ts
class Resolver {
  constructor(@Inject(MESSAGE_QUEUES.custom) private queue: MessageQueueService) {}

  async onSomeAction() {
    //business logic
    await this.queue.add(someData);
  }
}

//async worker
class CustomWorker {
  constructor(@Inject(MESSAGE_QUEUES.custom) private queue: MessageQueueService) {
    this.initWorker();
  }

  async initWorker() {
    await this.queue.work(async ({ id, data }) => {
      //worker logic
    });
  }
}
```


---
title: Meldingskø
image: /images/user-guide/emails/emails_header.png
---

<Frame>
  <img src="/images/user-guide/emails/emails_header.png" alt="Header" />
</Frame>

Køer gjør det lettere å utføre asynkrone operasjoner. De kan brukes til å utføre bakgrunnsoppgaver som å sende en velkomst-e-post ved registrering.
Hver brukstilfelle vil ha sin egen køklasse utvidet fra `MessageQueueServiceBase`.

For øyeblikket støtter vi kun `bull-mq`[bull-mq](https://bullmq.io/) som kødriver.

## Steg for å lage og bruke en ny kø

1. Legg til et kønavn for den nye køen under enum `MESSAGE_QUEUES`.
2. Gi fabrikkimplementeringen av køen med kønavnet som avhengighetstoken.
3. Injiser køen som du har opprettet i den nødvendige modulen/tjenesten med kønavnet som avhengighetstoken.
4. Legg til en klasse for arbeider med token-basert injisering, akkurat som produsent.

### Eksempel på bruk

```ts
class Resolver {
  constructor(@Inject(MESSAGE_QUEUES.custom) private queue: MessageQueueService) {}

  async onSomeAction() {
    //business logic
    await this.queue.add(someData);
  }
}

//async worker
class CustomWorker {
  constructor(@Inject(MESSAGE_QUEUES.custom) private queue: MessageQueueService) {
    this.initWorker();
  }

  async initWorker() {
    await this.queue.work(async ({ id, data }) => {
      //worker logic
    });
  }
}
```


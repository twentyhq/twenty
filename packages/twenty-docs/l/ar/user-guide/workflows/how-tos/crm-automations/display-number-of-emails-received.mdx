---
title: عرض عدد رسائل البريد الإلكتروني المستلمة
description: أنشئ سير عمل لحساب عدد رسائل البريد الإلكتروني المستلمة من كل جهة اتصال وعرضه تلقائيًا.
---

import { VimeoEmbed } from '/snippets/vimeo-embed.mdx';

<img src="/images/user-guide/workflows/workflow-number-of-emails-received.png" style={{width:'100%'}} />

## نظرة عامة

يعمل سير العمل هذا في كل مرة يتم فيها استلام بريد إلكتروني جديد، ويحدّث حقلًا مخصصًا في سجل Person بالقيمة الإجمالية لعدد الرسائل من ذلك المرسِل.

## المتطلبات الأساسية

قبل إعداد سير العمل هذا، أنشئ حقلًا مخصصًا على كائن **People**:

1. اذهب إلى **الإعدادات → نموذج البيانات → People**
2. أضف حقل **Number** جديدًا
3. قم بتسميته بشيء مثل "عدد رسائل البريد الإلكتروني المستلمة من هذا الشخص"

## إعداد خطوة بخطوة

<VimeoEmbed videoId="1148700336" title="عرض توضيحي بالفيديو" />

### الخطوة 1: تهيئة المشغّل

1. انتقل إلى **سير العمل** وأنشئ سير عمل جديدًا
2. اختر **Record is Created** كالمشغّل
3. اختر **Message Participants** (متوفر ضمن الكائنات المتقدمة)

<Note>
  يمثّل Message Participant مزيجًا بين معرّف الرسالة ومعرّف الشخص، ما ينشئ سجلًا فريدًا واحدًا لكل رسالة. يكون هذا أسهل في التتبع من Messages مباشرةً لأننا نستطيع الوصول إلى الحقل `handle` الذي يحتوي على عنوان البريد الإلكتروني للمرسل (أو المستلم).
</Note>

### الخطوة 2: التصفية حسب Role

1. أضف إجراء **Filter**
2. عيّن الشرط: **Role** يساوي **FROM**

يضمن هذا أن تحسب الرسائل المُرسلة من هذا الشخص فقط، وليس الرسائل المُرسلة إليه.

### الخطوة 3: البحث عن جميع Message Participants الذين لديهم نفس الـ Handle

1. أضف إجراء **Search Records**
2. حدّد **Message Participants** كالكائن
3. أضف عوامل تصفية: **Handle** يساوي الـ handle من المشغّل (عنوان البريد الإلكتروني للمرسل) و**Role** يساوي **FROM**
4. قم بزيادة **Limit** من 1 إلى **200** (الحد الأقصى)

هذا يعثر على جميع الرسائل من عنوان البريد الإلكتروني هذا للحصول على العدد الإجمالي.

<Note>
  إجراء Search Records محدود بإرجاع 200 سجل كحد أقصى. ومع ذلك، بما أنك تستخدم قيمة `totalCount` فقط (وليس السجلات الفردية)، فستُرجِع هذه الخطوة إجمالي عدد رسائل البريد الإلكتروني المُرسلة من هذا الشخص.
</Note>

### الخطوة 4: تحديث سجل Person باستخدام إجراء Create or Update Record

1. أضف إجراء **Create or Update Record**

<Warning>
  استخدم **Upsert Record** بدلًا من **Update Record** هنا. يتيح لك هذا تحديد الشخص عبر عنوان بريده الإلكتروني (حقل `handle`) بدلًا من اشتراط معرّف سجل من خطوة سابقة.
</Warning>

2. حدّد **People** كالكائن
3. اعثر على الشخص بمطابقة بريده الإلكتروني مع قيمة `handle` من Message Participant
4. عيّن الحقل المخصص "عدد رسائل البريد الإلكتروني المستلمة" إلى `{{searchRecords.totalCount}}`

تمثّل قيمة `totalCount` من إجراء Search Records إجمالي عدد رسائل البريد الإلكتروني المستلمة من هذا الشخص.

## ذات صلة

* [إجراءات سير العمل](/l/ar/user-guide/workflows/capabilities/workflow-actions)
* [إنشاء حقول مخصصة](/l/ar/user-guide/data-model/how-tos/customize-your-data-model)
* [إجراء Search Records](/l/ar/user-guide/workflows/capabilities/workflow-actions#search-records)

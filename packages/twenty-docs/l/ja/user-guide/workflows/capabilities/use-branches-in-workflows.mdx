---
title: ワークフローでブランチを使用する
description: ブランチの仕組みと、どのパスが実行されるかの制御方法を理解します。
---

## ブランチの仕組み

ワークフローエディタでは、1 つのノードから分岐する複数のパス（ブランチ）を作成できます。 これにより、異なる結果を持つ複雑な自動化を構築できます。

**重要**: ワークフローが実行されると、**既定ではすべてのブランチが並列に実行されます**。 あるブランチを選択するための組み込みの "if/else" ロジックはありません—すべてのパスが同時に実行されます。

## どのブランチを実行するかの制御

特定の条件に基づいて 1 つのブランチのみを実行するには、**各ブランチの先頭に Filter ノードを追加**します。

### セットアップ例

1. 1 つのノードから複数のブランチを持つワークフローを作成します
2. 各ブランチの最初のステップとして **Filter** ノードを追加します
3. 各 Filter に条件を設定し、そのブランチをいつ続行するかを決めます
4. Filter の条件を満たしたブランチだけが続行します

<img src="/images/user-guide/workflows/branches-with-filters.png" style={{width:'100%'}} />

### Filter の仕組み

* Filter の条件が**満たされた**場合：ブランチは実行を継続します
* Filter の条件が**満たされない**場合：ブランチは Filter ノードで停止します

これにより、データに基づいて該当するブランチだけが実行される条件付きロジックを実質的に作成できます。

## 例：商談金額でルーティング

**シナリオ**: 商談がクローズされたとき、商談金額に応じて異なる通知を送信します。

1. **トリガー**: Opportunity が更新（Stage = Closed Won）
2. **ブランチ 1**: Amount > $10,000 で Filter → #big-deals に Slack メッセージを送信
3. **ブランチ 2**: Amount ≤ $10,000 で Filter → 営業マネージャーにメールを送信

両方のブランチが開始されますが、商談金額に一致する方だけが Filter を通過して続行します。

## ブランチの作成

<Note>
  既存のステップから新しいブランチを作成するには、そのステップの **+** ボタンをクリックしてアクションを追加します。 **+** を複数回クリックすると、複数のブランチを追加できます。
</Note>

1. ワークフローエディタで、分岐させたいステップを選択します
2. アクションを追加するには **+** ボタンをクリックします
3. これで 1 つのブランチが作成されます
4. 同じステップで **+** をもう一度クリックして、ブランチを追加作成します
5. 各ブランチは独自のアクションのシーケンスを持てます

## ブランチを再結合する

並列ブランチが処理を完了したら、単一のパスに再結合できます:

1. 分岐したアクションを完了します
2. すべてのブランチの後に実行すべき新しいステップを追加します
3. 各ブランチの最後のステップからこの新しいステップに接続をドラッグします
4. マージされたステップは、接続されたすべてのブランチが完了するまで待機してから実行されます

### 例：処理後に通知

```
トリガー
   │
   ├── ブランチ A: 顧客レコードを更新
   │
   └── ブランチ B: サポートチケットを作成

       ↘  ↙

   マージされたステップ: 確認メールを送信
```

確認メールは、顧客の更新とチケットの作成の両方が完了してから送信されます。

## ベストプラクティス

* 条件付きで実行したい場合は、ブランチの開始時に常に**Filter ノード**を使用します
* 重複したアクションを避けるために、ブランチの条件は**相互排他的**に保ちます
* さまざまなデータでワークフローをテストし、正しいブランチが実行されることを確認します
* **ブランチのステップ名を変更**して、各パスが何を行うかが明確に分かるようにします
* 並列処理の後に最終アクションが必要な場合は、**ブランチをマージ**します

## 関連

* [ワークフロー FAQ](/l/ja/user-guide/workflows/how-tos/need-more-help/workflows-faq) — 並列実行に関する回答
* [ワークフローのアクション](/l/ja/user-guide/workflows/capabilities/workflow-actions) — ブランチで利用可能なアクション

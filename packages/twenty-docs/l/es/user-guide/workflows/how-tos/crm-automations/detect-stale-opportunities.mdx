---
title: Detectar oportunidades estancadas
description: Notifica autom√°ticamente a los gerentes cuando las oportunidades no se han actualizado.
---

Mant√©n tu pipeline saludable informando a los gerentes cuando las oportunidades se estanquen. Este flujo de trabajo revisa las oportunidades que no se han actualizado en un n√∫mero espec√≠fico de d√≠as.

## Problema

Las oportunidades sin actualizaciones provocan:

* Acuerdos que se enfr√≠an
* Pron√≥sticos poco fiables
* P√©rdida de ingresos

## La soluci√≥n

Crea un flujo de trabajo programado que encuentre oportunidades estancadas y env√≠e correos electr√≥nicos a sus gerentes.

## Configuraci√≥n paso a paso

### Paso 1: Crear el flujo de trabajo

1. Ve a **Configuraci√≥n ‚Üí Flujos de trabajo**
2. Haz clic en **+ Nuevo flujo de trabajo**
3. As√≠gnale el nombre "Alerta de oportunidades estancadas"

### Paso 2: Configurar el disparador

1. Selecciona **On a Schedule**
2. Config√∫ralo para ejecutarse diariamente (p. ej., todos los d√≠as a las 8 a. m.)

### Paso 3: Buscar oportunidades estancadas

1. A√±ade la acci√≥n **Search Records**
2. Configurar:

| Campo      | Valor                                          |
| ---------- | ---------------------------------------------- |
| **Objeto** | Oportunidades                                  |
| **Filtro** | Updated At es anterior a (hoy - 7 d√≠as)        |
| **Filtro** | Stage no es "Closed Won" Y no es "Closed Lost" |
| **L√≠mite** | 100                                            |

### Paso 4: Comprobar si se encontr√≥ algo

1. A√±ade la acci√≥n **Filter**
2. Condici√≥n: `{{searchRecords.length}}` es mayor que 0
3. Si no hay oportunidades estancadas, el flujo de trabajo se detiene aqu√≠

### Paso 5: Formatear la alerta (acci√≥n de c√≥digo)

A√±ade una acci√≥n **Code** para formatear el correo electr√≥nico:

```javascript
export const main = async (params) => {
  const opportunities = params.opportunities;

  // Group opportunities by owner
  const byOwner = {};
  opportunities.forEach(opp => {
    const ownerEmail = opp.owner?.email || 'unassigned';
    if (!byOwner[ownerEmail]) {
      byOwner[ownerEmail] = [];
    }
    byOwner[ownerEmail].push({
      name: opp.name,
      amount: opp.amount,
      lastUpdated: opp.updatedAt,
      stage: opp.stage
    });
  });

  // Format summary for manager
  let summary = "Stale Opportunities Report\n\n";
  Object.entries(byOwner).forEach(([owner, opps]) => {
    summary += `${owner}: ${opps.length} stale opportunities\n`;
    opps.forEach(opp => {
      summary += `  - ${opp.name} (${opp.stage})\n`;
    });
    summary += "\n";
  });

  return {
    summary,
    totalCount: opportunities.length
  };
};
```

### Paso 6: Enviar correo de alerta

A√±ade la acci√≥n **Send Email**:

| Campo      | Valor                                                                |
| ---------- | -------------------------------------------------------------------- |
| **Para**   | sales-manager@yourcompany.com                                        |
| **Asunto** | `üö® {{code.totalCount}} oportunidades estancadas requieren atenci√≥n` |
| **Cuerpo** | `{{code.summary}}`                                                   |

### Paso 7: Probar y activar

1. Haz clic en **Test** para ejecutar el flujo de trabajo
2. Verifica que el correo electr√≥nico contenga los datos correctos
3. Act√≠valo cuando est√© listo

## Opciones de personalizaci√≥n

### Cambiar el umbral de estancamiento

Modifica el filtro de Search Records para cambiar de 7 d√≠as a tu periodo preferido:

* 3 d√≠as para ventas de alto ritmo
* 14 d√≠as para acuerdos empresariales
* 30 d√≠as para ciclos de ventas largos

### Alertar a los representantes individuales

En lugar de un solo correo para el gerente, usa **Iterator** para enviar correos personalizados a cada representante sobre sus propios acuerdos estancados.

### Agregar escalamiento

Crea varios flujos de trabajo con severidad creciente:

1. D√≠a 7: Correo al representante
2. D√≠a 14: Correo al representante + gerente
3. D√≠a 21: Crear una tarea para que el gerente intervenga

### Incluir en Slack

Usa **HTTP Request** para publicar en un webhook de Slack en lugar del correo electr√≥nico o adem√°s de este.

## Relacionado

* [Acciones de flujos de trabajo](/l/es/user-guide/workflows/capabilities/workflow-actions)
* [Enviar correos electr√≥nicos desde flujos de trabajo](/l/es/user-guide/workflows/capabilities/send-emails-from-workflows)
